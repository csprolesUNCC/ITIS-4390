<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Whole Foods Cart</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="app.css">
</head>

<body>

<div class="mobile-container">

    <div class="px-4 relative mb-4 mt-4">
        <div class="flex items-center justify-between">
            <button onclick="history.back()" aria-label="Go back" class="px-3 py-2 bg-green-700 hover:bg-green-600 text-white rounded-full flex items-center space-x-2">
            <span class="text-sm font-medium">‚Üê Back</span>
            </button>

            <div class="h-12 w-12 rounded-full overflow-hidden">
                <img src="img/logo.png" alt="Whole Foods Logo" class="h-full w-full object-cover">
            </div>
        </div>

            <h1 class="absolute inset-0 flex items-center justify-center text-white text-3xl font-light pointer-events-none">Cart</h1>
    </div>
    

    <div class="content-area">
        <div id="cart-items-container">
            <!-- Cart items will be dynamically inserted here -->
        </div>

        <div id="empty-cart-message" class="text-center py-12 hidden">
            <div class="text-6xl mb-4">üõí</div>
            <p class="text-white text-lg mb-2">Your cart is empty</p>
            <p class="text-gray-400 text-sm mb-6">Add some delicious items to get started!</p>
            <a href="shop.html" class="inline-block bg-green-700 text-white px-6 py-3 rounded-full hover:bg-green-600">
                Start Shopping
            </a>
        </div>
    </div>

    <div class="px-4 pb-24" id="cart-summary-section">    
        <!-- Price Summary Box -->
        <div class="bg-green-800 text-white p-4 rounded-md mt-6 shadow-md">
            <div class="flex justify-between mb-1">
                <span class="text-sm">Subtotal</span>
                <span class="font-medium" id="subtotal">$0.00</span>
            </div>
            <div class="flex justify-between mb-1">
                <span class="text-sm">Estimated Tax</span>
                <span class="font-medium" id="tax">$0.00</span>
            </div>
            <div class="flex justify-between border-t border-green-600 mt-2 pt-2">
                <span class="font-semibold">Total</span>
                <span class="font-semibold" id="total">$0.00</span>
            </div>
        </div>

        <!-- Checkout Button -->
        <a href="payment.html" class="block w-full bg-green-700 text-white font-medium py-3 rounded-full mt-4 text-lg text-center hover:bg-green-600">
            Checkout
        </a>
    </div>

    <!-- Bottom Navigation -->
    <nav class="absolute bottom-0 left-0 right-0 max-w-sm mx-auto bg-green-800 text-white flex justify-around py-3">
        <a href="home.html" class="flex flex-col items-center text-xs text-white">
            <span class="text-lg">üè†</span>
            Home
        </a>
        <a href="shop.html" class="flex flex-col items-center text-xs text-green-300 font-bold">
            <span class="text-lg">üõí</span>
            Cart
        </a>
        <a href="search.html" class="flex flex-col items-center text-xs">
            <span class="text-lg">üîé</span>
            Search
        </a>
        <a href="profile.html" class="flex flex-col items-center text-xs">
            <span class="text-lg">üë§</span>
            Profile
        </a>
    </nav>

</div>

<script src="cart-manager.js"></script>
<script>
    const PRODUCT_IMAGE_MAP = {
      101: 'img/bananas.png',
      102: 'img/honeycrisp_apple.png',
      103: 'img/baby_spinach.png',
      201: 'img/85lean_beef.png',
      202: 'img/salmon.png',
      203: 'img/free_range_chicken.png',
      301: 'img/milk.png',
      302: 'img/eggs.png',
      303: 'img/greek_yogurt.png',
      801: 'img/rotisserie_chicken.png',
      401: 'img/sourdough.png'
    };

    function renderCartItems() {
        const container = document.getElementById('cart-items-container');
        const emptyMessage = document.getElementById('empty-cart-message');
        const summarySection = document.getElementById('cart-summary-section');
        const items = window.cartManager.getItems();

        if (items.length === 0) {
            container.innerHTML = '';
            emptyMessage.classList.remove('hidden');
            summarySection.classList.add('hidden');
            return;
        }

        emptyMessage.classList.add('hidden');
        summarySection.classList.remove('hidden');

        container.innerHTML = items.map(item => {
            const imageSrc = PRODUCT_IMAGE_MAP[item.id] || item.image || 'img/placeholder.png';
            const itemTotal = (item.price * item.quantity).toFixed(2);

            return `
                <div class="bg-white rounded-md p-3 mb-4 flex items-center shadow-sm border border-gray-100">
                    <div class="w-20 h-20 bg-gray-100 rounded-md mr-4 overflow-hidden flex-shrink-0">
                        <img src="${imageSrc}" alt="${item.name}" class="w-full h-full object-cover" onerror="this.src='img/placeholder.png'">
                    </div>

                    <div class="flex-grow">
                        <p class="font-medium text-gray-800 text-sm">${item.name}</p>
                        <p class="text-xs text-gray-500 mb-1">$${item.price.toFixed(2)} each</p>

                        <div class="flex items-center space-x-3 mt-1">
                            <button onclick="updateItemQuantity(${item.id}, -1)" class="w-6 h-6 flex items-center justify-center bg-gray-200 rounded-full text-gray-700 hover:bg-gray-300">-</button>
                            <span class="text-gray-800 font-medium">${item.quantity}</span>
                            <button onclick="updateItemQuantity(${item.id}, 1)" class="w-6 h-6 flex items-center justify-center bg-gray-200 rounded-full text-gray-700 hover:bg-gray-300">+</button>
                        </div>
                    </div>

                    <div class="flex flex-col items-end">
                        <p class="text-gray-900 font-semibold mb-2">$${itemTotal}</p>
                        <button onclick="removeItem(${item.id})" class="text-xs text-red-600 hover:text-red-800">Remove</button>
                    </div>
                </div>
            `;
        }).join('');

        updateSummary();
    }

    function updateSummary() {
        const subtotal = window.cartManager.getTotal();
        const tax = subtotal * 0.07; // 7% tax
        const total = subtotal + tax;

        document.getElementById('subtotal').textContent = `$${subtotal.toFixed(2)}`;
        document.getElementById('tax').textContent = `$${tax.toFixed(2)}`;
        document.getElementById('total').textContent = `$${total.toFixed(2)}`;
    }

    function updateItemQuantity(productId, delta) {
        const items = window.cartManager.getItems();
        const item = items.find(i => i.id === productId);
        
        if (item) {
            const newQuantity = item.quantity + delta;
            window.cartManager.updateQuantity(productId, newQuantity);
            renderCartItems();
        }
    }

    function removeItem(productId) {
        if (confirm('Remove this item from your cart?')) {
            window.cartManager.removeItem(productId);
            renderCartItems();
        }
    }

    // Subscribe to cart changes
    window.cartManager.subscribe(() => {
        renderCartItems();
    });

    // Initial render
    document.addEventListener('DOMContentLoaded', () => {
        renderCartItems();
    });
</script>

</body>
</html>